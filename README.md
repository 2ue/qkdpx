# QKDPX - NPM å¿«é€Ÿå‘å¸ƒå·¥å…·

ä¸€ä¸ªç°ä»£åŒ–çš„ CLI å·¥å…·ï¼Œç”¨äº npm åŒ…çš„è‡ªåŠ¨åŒ–å‘å¸ƒæµç¨‹ï¼Œæ”¯æŒ git æäº¤ã€ç‰ˆæœ¬ç®¡ç†å’Œå®‰å…¨çš„é…ç½®ç®¡ç†ã€‚

## ç‰¹æ€§

- ğŸ” **æ™ºèƒ½æ£€æµ‹** - è‡ªåŠ¨æ£€æµ‹æœªæäº¤çš„å˜æ›´å’Œå½“å‰ç‰ˆæœ¬çŠ¶æ€
- ğŸ“ **äº¤äº’å¼æäº¤** - å¼•å¯¼ç”¨æˆ·è¾“å…¥æäº¤ä¿¡æ¯å¹¶è‡ªåŠ¨æäº¤
- ğŸ·ï¸ **è¯­ä¹‰åŒ–ç‰ˆæœ¬** - æ”¯æŒ patch/minor/major ç‰ˆæœ¬å‡çº§
- ğŸ”¨ **è‡ªåŠ¨æ„å»º** - å‘å¸ƒå‰è‡ªåŠ¨è¿è¡Œæ„å»ºè„šæœ¬ï¼ˆå¦‚æœå­˜åœ¨ build è„šæœ¬ï¼‰
- ğŸ“¦ **å®‰å…¨å‘å¸ƒ** - æ”¯æŒå¤šç§ npm registry å’ŒåŠ å¯†çš„ auth token å­˜å‚¨
- ğŸ” **ç»Ÿä¸€é…ç½®** - å…¨å±€é…ç½®ç®¡ç†ï¼Œé¿å…é…ç½®å†²çªå’Œè®¤è¯é—®é¢˜
- ğŸ” **å®‰å…¨è®¤è¯** - auth token é‡‡ç”¨ AES-256-CBC åŠ å¯†å­˜å‚¨
- âš¡ **ç°ä»£åŒ–å·¥å…·** - åŸºäº TypeScript + Node.js æ„å»ºï¼Œä½¿ç”¨ ES æ¨¡å—

## å®‰è£…

### æœ¬åœ°å¼€å‘å®‰è£…

```bash
# å…‹éš†é¡¹ç›®
git clone <repository-url>
cd dpx

# å®‰è£…ä¾èµ–
npm install

# æ„å»ºé¡¹ç›®
npm run build

# æœ¬åœ°é“¾æ¥ï¼ˆå¼€å‘è°ƒè¯•ï¼‰
npm link
```

### ä» NPM å®‰è£…ï¼ˆè®¡åˆ’ä¸­ï¼‰

```bash
# å…¨å±€å®‰è£…
npm install -g qkdpx

# æˆ–åœ¨é¡¹ç›®ä¸­ä½¿ç”¨
npx qkdpx publish
```

## ä½¿ç”¨

### åŸºæœ¬ç”¨æ³•

```bash
# å‘å¸ƒå½“å‰é¡¹ç›®
qkdpx publish

# æŒ‡å®šç‰ˆæœ¬ç±»å‹
qkdpx publish --version patch
qkdpx publish --version minor
qkdpx publish --version major

# è·³è¿‡ç¡®è®¤æç¤º
qkdpx publish --skip-confirm

# è¯•è¿è¡Œï¼ˆä¸å®é™…å‘å¸ƒï¼‰
qkdpx publish --dry-run
```

### é…ç½®ç®¡ç†

```bash
# åˆå§‹åŒ–é…ç½®
qkdpx init

# æŸ¥çœ‹å½“å‰é…ç½®
qkdpx init --show
```

### å·¥ä½œæµç¨‹

1. **ğŸ” å˜æ›´æ£€æµ‹** - æ£€æŸ¥ git å·¥ä½œåŒºçŠ¶æ€å’Œ package.json ä¿¡æ¯
2. **ğŸ“ äº¤äº’å¼æäº¤** - å¦‚æœ‰æœªæäº¤æ–‡ä»¶ï¼Œå¼•å¯¼ç”¨æˆ·è¾“å…¥æäº¤ä¿¡æ¯
3. **ğŸ·ï¸ ç‰ˆæœ¬å‡çº§** - äº¤äº’å¼é€‰æ‹© patch/minor/major å¹¶æ›´æ–° package.json
4. **ğŸ”¨ æ„å»ºéªŒè¯** - è‡ªåŠ¨è¿è¡Œ `npm run build`ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
5. **ğŸ“¦ å‘å¸ƒæ‰§è¡Œ** - ä½¿ç”¨é…ç½®çš„ registry å’Œ auth token å‘å¸ƒåˆ° npm

æ¯ä¸ªæ­¥éª¤éƒ½æœ‰æ¸…æ™°çš„è¿›åº¦æ˜¾ç¤ºå’Œé”™è¯¯å¤„ç†ã€‚

## é…ç½®æ–‡ä»¶

### å…¨å±€é…ç½® (`~/.qkdpx/config.json`)

qkdpx ä½¿ç”¨å•ä¸€çš„å…¨å±€é…ç½®ç³»ç»Ÿï¼Œæ‰€æœ‰é…ç½®éƒ½å­˜å‚¨åœ¨ç”¨æˆ·ä¸»ç›®å½•ï¼š

```json
{
  "registry": "https://registry.npmjs.org/",
  "authToken": "<encrypted-token>"
}
```

### å®‰å…¨è¯´æ˜

- **Auth token åŠ å¯†å­˜å‚¨**: ä½¿ç”¨ AES-256-CBC åŠ å¯†ç®—æ³•ä¿æŠ¤è®¤è¯ä¿¡æ¯
- **é…ç½®æ–‡ä»¶æƒé™**: å…¨å±€é…ç½®æ–‡ä»¶åªæœ‰å½“å‰ç”¨æˆ·å¯è®¿é—®
- **æ˜¾ç¤ºæ—¶æ©ç **: Auth token åœ¨æ˜¾ç¤ºæ—¶è‡ªåŠ¨æ©ç ä¸º `abc***xyz` æ ¼å¼

## å¼€å‘

```bash
# å®‰è£…ä¾èµ–
npm install

# å¼€å‘æ¨¡å¼
npm run dev

# æ„å»º
npm run build

# ä»£ç æ£€æŸ¥
npm run lint
npm run typecheck

# æ ¼å¼åŒ–ä»£ç 
npm run format
```

## æŠ€æœ¯æ¶æ„

### æ ¸å¿ƒä¾èµ–

- **commander.js** - CLI æ¡†æ¶å’Œå‘½ä»¤è§£æ
- **inquirer** - äº¤äº’å¼å‘½ä»¤è¡Œç•Œé¢
- **listr2** - ä»»åŠ¡åˆ—è¡¨ç®¡ç†å’Œè¿›åº¦æ˜¾ç¤º
- **semver** - è¯­ä¹‰åŒ–ç‰ˆæœ¬ç®¡ç†
- **fs-extra** - å¢å¼ºçš„æ–‡ä»¶ç³»ç»Ÿæ“ä½œ
- **chalk** - ç»ˆç«¯é¢œè‰²å’Œæ ·å¼
- **ora** - ä¼˜é›…çš„ç»ˆç«¯ spinner

### è®¾è®¡ç‰¹ç‚¹

- **åŸç”Ÿ git å‘½ä»¤** - ä½¿ç”¨ `child_process.spawn` ç›´æ¥è°ƒç”¨ï¼Œæ— é¢å¤–ä¾èµ–
- **ES æ¨¡å—** - å®Œå…¨æ”¯æŒç°ä»£ JavaScript æ¨¡å—ç³»ç»Ÿ
- **TypeScript** - ç±»å‹å®‰å…¨å’Œæ›´å¥½çš„å¼€å‘ä½“éªŒ
- **æ¨¡å—åŒ–æ¶æ„** - æ¸…æ™°çš„èŒè´£åˆ†ç¦»å’Œä»£ç ç»„ç»‡
- **åŠ å¯†å­˜å‚¨** - ä½¿ç”¨ Node.js åŸç”Ÿ crypto æ¨¡å—åŠ å¯†æ•æ„Ÿä¿¡æ¯

### é¡¹ç›®ç»“æ„

```
src/
â”œâ”€â”€ commands/           # CLI å‘½ä»¤å®ç°
â”‚   â”œâ”€â”€ init.ts        # init å‘½ä»¤
â”‚   â””â”€â”€ publish.ts     # publish å‘½ä»¤
â”œâ”€â”€ modules/           # æ ¸å¿ƒåŠŸèƒ½æ¨¡å—
â”‚   â”œâ”€â”€ ChangeDetector.ts   # å˜æ›´æ£€æµ‹
â”‚   â”œâ”€â”€ CommitManager.ts    # Git æäº¤ç®¡ç†
â”‚   â”œâ”€â”€ VersionManager.ts   # ç‰ˆæœ¬ç®¡ç†
â”‚   â””â”€â”€ PublishManager.ts   # å‘å¸ƒç®¡ç†
â”œâ”€â”€ utils/             # å·¥å…·ç±»
â”‚   â”œâ”€â”€ ConfigManager.ts    # é…ç½®ç®¡ç†
â”‚   â””â”€â”€ GitHelper.ts       # Git æ“ä½œå°è£…
â”œâ”€â”€ types/             # TypeScript ç±»å‹å®šä¹‰
â””â”€â”€ index.ts           # å…¥å£æ–‡ä»¶
```

## æœªæ¥è§„åˆ’

### v0.2.0
- [ ] æ”¯æŒè‡ªå®šä¹‰æ„å»ºå‘½ä»¤é…ç½®
- [ ] æ·»åŠ å‘å¸ƒå‰æµ‹è¯•è¿è¡Œé€‰é¡¹
- [ ] æ”¯æŒ monorepo é¡¹ç›®ç»“æ„
- [ ] æ·»åŠ å‘å¸ƒå†å²è®°å½•

### v0.3.0
- [ ] æ”¯æŒ changelog è‡ªåŠ¨ç”Ÿæˆ
- [ ] é›†æˆ conventional commits
- [ ] æ”¯æŒå‘å¸ƒåˆ°å¤šä¸ª registry
- [ ] æ·»åŠ å›æ»šåŠŸèƒ½

### v1.0.0
- [ ] å®Œæ•´çš„æ’ä»¶ç³»ç»Ÿ
- [ ] Web UI é…ç½®ç•Œé¢
- [ ] CI/CD é›†æˆæ¨¡æ¿
- [ ] å®Œå–„çš„æ–‡æ¡£å’Œç¤ºä¾‹

## è®¸å¯è¯

MIT